
@{
    ViewBag.Title = "MisRutas";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



<!--<section class="w-100">
    <div class="surface-wrapper gradient shadow-sm p-4 p-md-5">-->
<!-- Encabezado -->
<!--<header class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h4 mb-1">Introducción AI</h1>
        <p class="mb-0 ec-muted">Ruta de Educlick</p>
    </div>
    <button class="btn btn-dark rounded-3">Iniciar Ruta</button>
</header>-->
<!-- Cantidad de cursos -->
<!--<h2 class="h6 fw-semibold mb-2">3 Cursos</h2>
<hr class="opacity-50" />-->
<!-- Lista de cursos como botones -->
<!--<div class="d-grid gap-3 col-12 col-xl-10 mx-auto mt-4">-->
<!-- Curso 1 -->
<!--<button type="button" class="btn btn-course text-start d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center gap-3">
        <span class="badge rounded-circle bg-light text-dark px-3 py-2">AI</span>
        <span class="fw-semibold">Curso de introducción a la Inteligencia Artificial</span>
    </div>
    <div class="d-flex align-items-center gap-2">
        <span class="fw-semibold">0%</span>
        <div class="progress w-100" style="width: 120px;" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-bar bg-dark" style="width: 0%"></div>
        </div>
    </div>
</button>-->
<!-- Curso 2 -->
<!--<button type="button" class="btn btn-course text-start d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center gap-3">
        <span class="badge rounded-circle bg-light text-dark px-3 py-2">AI</span>
        <span class="fw-semibold">Curso de Estrategia y liderazgo Gen AI</span>
    </div>
    <div class="d-flex align-items-center gap-2">
        <span class="fw-semibold">0%</span>
        <div class="progress w-100" style="width: 120px;" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
            <div class="progress-bar bg-dark" style="width: 0%"></div>
        </div>
    </div>
</button>-->
<!-- Curso 3 -->
<!--<button type="button" class="btn btn-course text-start d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-3">
                    <span class="badge rounded-circle bg-light text-dark px-3 py-2">AI</span>
                    <span class="fw-semibold">Curso de ChatGPT</span>
                </div>
                <div class="d-flex align-items-center gap-2">
                    <span class="fw-semibold">0%</span>
                    <div class="progress w-100" style="width: 120px;" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                        <div class="progress-bar bg-dark" style="width: 0%"></div>
                    </div>
                </div>
            </button>

        </div>
    </div>
</section>-->
@model List<CapaEntidad.Ruta>

<section class="w-100">
    <div class="surface-wrapper gradient shadow-sm p-4 p-md-5">

        <!-- Encabezado -->
        <header class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1 class="h4 mb-1">Rutas disponibles</h1>
                <p class="mb-0 ec-muted">Seleccioná una para comenzar</p>
            </div>
        </header>

        <!-- Lista de rutas desde BD -->
        <div class="d-grid gap-3 col-12 col-xl-10 mx-auto mt-4">
            @foreach (var ruta in Model)
            {
                <button type="button"
                        class="btn btn-course text-start d-flex justify-content-between align-items-center"
                        data-bs-toggle="modal"
                        data-bs-target="#confirmarRutaModal"
                        data-nombre="@ruta.Nombre"
                        data-id="@ruta.IdRuta">
                    <div class="d-flex align-items-center gap-3">
                        <span class="badge rounded-circle bg-light text-dark px-3 py-2">@ruta.Codigo</span>
                        <span class="fw-semibold">@ruta.Nombre</span>
                    </div>
                    <div class="d-flex align-items-center gap-2">
                        <span class="fw-semibold">0%</span>
                        <div class="progress" style="width: 120px;">
                            <div class="progress-bar bg-dark" style="width: 0%"></div>
                        </div>
                    </div>
                </button>
            }
        </div>
    </div>
</section>

<!-- Modal de confirmación -->
<div class="modal fade" id="confirmarRutaModal" tabindex="-1" aria-labelledby="confirmarRutaLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content rounded-4">
            <div class="modal-header bg-success text-white rounded-top-4">
                <h5 class="modal-title" id="confirmarRutaLabel">Confirmar inicio</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body text-center">
                <p class="fs-5">Usted está por iniciar la ruta seleccionada:</p>
                <h4 class="fw-bold text-success" id="nombreRutaSeleccionada"></h4>
            </div>
            <div class="modal-footer justify-content-center">
                <button type="button" class="btn btn-outline-dark rounded-pill px-4" data-bs-dismiss="modal">Cancelar</button>
                <form method="post" action="@Url.Action("IniciarRuta", "Alumno")">
                    <input type="hidden" id="rutaSeleccionadaId" name="idRuta" />
                    <button type="submit" class="btn btn-dark rounded-pill px-4">Confirmar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Toast de confirmación -->
<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="rutaToast" class="toast align-items-center text-bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="d-flex">
            <div class="toast-body">
                Ruta iniciada correctamente 🎉
            </div>
            <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
        </div>
    </div>
</div>

<script>
    // Pasar datos al modal
    const confirmarModal = document.getElementById('confirmarRutaModal');
    confirmarModal.addEventListener('show.bs.modal', event => {
        const button = event.relatedTarget;
        const nombre = button.getAttribute('data-nombre');
        const id = button.getAttribute('data-id');

        document.getElementById('nombreRutaSeleccionada').textContent = nombre;
        document.getElementById('rutaSeleccionadaId').value = id;
    });

    // Mostrar toast si se inició correctamente
    document.addEventListener("DOMContentLoaded", function () {
        const mensaje = '@TempData["MensajeRuta"]';
        if (mensaje && mensaje.length > 0) {
            const toast = new bootstrap.Toast(document.getElementById('rutaToast'));
            toast.show();
        }
    });
</script>

<style>
    :root {
        --ec-surface: #B9FF66;
        --ec-surface-end: #dcdcdc;
    }

    .surface-wrapper {
        min-height: 100vh;
        background: var(--ec-surface);
        color: #0b2210;
        width: 100%;
        border-radius: 0;
    }

        .surface-wrapper.gradient {
            background: linear-gradient(180deg, var(--ec-surface) 0%, var(--ec-surface) 35%, var(--ec-surface-end) 100%);
        }

    .ec-muted {
        color: #4a4a4a;
        font-size: 0.9rem;
    }

    .btn-course {
        border: 2px solid #000;
        border-radius: 1rem;
        background-color: rgba(255, 255, 255, 0.2);
        padding: 1rem;
        transition: background-color .2s, transform .1s;
    }

        .btn-course:hover {
            background-color: rgba(0,0,0,.05);
            transform: scale(1.01);
        }

    .progress {
        height: 8px;
    }

    .progress-bar {
        background-color: #000;
    }
</style>
